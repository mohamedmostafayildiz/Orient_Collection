<div id="medical-treaty-setup">
    <div class="container-fluid">
        <div class="outerBorder shadow_5">
            <form [formGroup]="MainForm">
                <div class="row">
                    <!--Col 1 -->
                    <div class="col-md-6">
                        <mat-form-field class="w-100" appearance="outline">
                            <mat-label>Name</mat-label>
                            <input formControlName="name" type="text" matInput>
                        </mat-form-field>

                        <mat-form-field class="w-100" appearance="outline">
                            <mat-label><span class="text-danger mx-1">*</span>Business Type</mat-label>
                            <mat-select formControlName="productId"
                                (selectionChange)="getSelectedBussType($event.value)">
                                <mat-option *ngFor="let item of BussnessTypes"
                                    value="{{item.id}}">{{item.productName}}</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                    <!-- Col 2 -->
                    <div class="col-md-6">
                        <mat-form-field class="w-100" appearance="outline">
                            <mat-label><span class="text-danger mx-1">*</span>Treaty Type</mat-label>
                            <mat-select formControlName="type" (selectionChange)="getSelectedTreatyType($event.value)">
                                <mat-option [value]="1">Proportional</mat-option>
                                <mat-option [value]="2">Non Proportional</mat-option>
                            </mat-select>
                        </mat-form-field>

                        <mat-form-field class="w-100" appearance="outline">
                            <mat-label><span class="text-danger mx-1">*</span>L.O.B</mat-label>
                            <mat-select formControlName="lineOfBusinessId">
                                <mat-option *ngFor="let item of LineOfBuss" [value]="item.id">{{item.name}}</mat-option>
                            </mat-select>
                        </mat-form-field>

                    </div>
                    <!--  -->
                    <div class="col-md-4">
                        <mat-form-field class="w-100" appearance="outline">
                            <mat-label>Inception Date</mat-label>
                            <input formControlName="from" (dateChange)="getFrom()" matInput [matDatepicker]="picker">
                            <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
                            <mat-datepicker #picker></mat-datepicker>
                        </mat-form-field>
                    </div>
                    <div class="col-md-4">
                        <mat-form-field class="w-100" appearance="outline">
                            <mat-label>Expiry Date</mat-label>
                            <input formControlName="to" matInput [matDatepicker]="picker1">
                            <mat-datepicker-toggle matIconSuffix [for]="picker1"></mat-datepicker-toggle>
                            <mat-datepicker #picker1></mat-datepicker>
                        </mat-form-field>
                    </div>
                    <div class="col-md-4">
                        <mat-form-field class="w-100" appearance="outline">
                            <mat-label>{{'Policy.UY'|translate}}</mat-label>
                            <input formControlName="underWritingYear" type="number" matInput>
                        </mat-form-field>
                    </div>

                    <!----------- Proportional --------------->
                    <div class="px-3 mt-2" id="Proportional" style="display: none;">
                        <form [formGroup]="proportionalForm">
                            <div class="assignBorder px-2 py-2">
                                <div class="row">
                                    <div class="col-md-4">
                                        <mat-form-field appearance="outline">
                                            <mat-label>Principle</mat-label>
                                            <mat-select formControlName="principle"
                                                (selectionChange)="getSelectedPrincipleType($event.value)">
                                                <mat-option [value]="1">RISK ATTACHED </mat-option>
                                                <mat-option [value]="2">LOSS OCCURANCE</mat-option>
                                                <!-- <mat-option [value]="1">U/Y</mat-option>
                                                <mat-option [value]="2">Accounting year</mat-option>
                                                <mat-option [value]="3">Clean cut</mat-option>
                                                <mat-option [value]="4">Revenue year</mat-option> -->
                                            </mat-select>
                                        </mat-form-field>
                                        <mat-form-field appearance="outline">
                                            <mat-label>Cash Loss Limit</mat-label>
                                            <input formControlName="cashCall" type="number" matInput>
                                        </mat-form-field>
                                        <mat-error *ngIf="proportionalForm.hasError('cashCall')">
                                             Loss Advice Limit must not be greater than Cash Loss Limit.
                                        </mat-error>
                                        <mat-form-field appearance="outline">
                                            <mat-label>Loss Reserve</mat-label>
                                            <mat-select formControlName="lossReserve">
                                                <mat-option [value]="1">Reserve release yearly</mat-option>
                                                <mat-option [value]="2">Half yearly</mat-option>
                                                <mat-option [value]="3">Qrter</mat-option>
                                                <mat-option [value]="4">4th qrt</mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                        <mat-form-field appearance="outline">
                                            <mat-label>Loss Reserve Pct</mat-label>
                                            <input formControlName="lossReservePct" min="0" max="100" type="number" matInput>
                                             <mat-icon matIconSuffix style="color: rgba(0, 0, 0, 0.65);"><i
                                        class="fa-solid fa-percent"></i></mat-icon>
                                        </mat-form-field>
                                          <mat-error *ngIf="proportionalForm.get('lossReservePct')?.hasError('min')">
                                            Value cannot be less than 0.
                                            </mat-error>
                                            <mat-error *ngIf="proportionalForm.get('lossReservePct')?.hasError('max')">
                                            Value cannot be more than 100.
                                            </mat-error>
                                         <mat-form-field appearance="outline">
                                            <mat-label>Profit Commission</mat-label>
                                            <input formControlName="profitCommission" min="0" max="100" type="number" matInput>
                                             <mat-icon matIconSuffix style="color: rgba(0, 0, 0, 0.65);"><i
                                        class="fa-solid fa-percent"></i></mat-icon>
                                        </mat-form-field>
                                         <mat-error *ngIf="proportionalForm.get('profitCommission')?.hasError('min')">
                                            Value cannot be less than 0.
                                            </mat-error>
                                            <mat-error *ngIf="proportionalForm.get('profitCommission')?.hasError('max')">
                                            Value cannot be more than 100.
                                            </mat-error>
                                        <mat-form-field class="w-100" appearance="outline">
                                            <mat-label>First Calculation Date years</mat-label>
                                            <input formControlName="firstCalculation" matInput
                                                [matDatepicker]="picker3">
                                            <mat-datepicker-toggle matIconSuffix
                                                [for]="picker3"></mat-datepicker-toggle>
                                            <mat-datepicker #picker3></mat-datepicker>
                                        </mat-form-field>
                                        <mat-form-field appearance="outline">
                                            <mat-label>Quota Share Commision</mat-label>
                                            <input formControlName="qoutaShareCommission" min="0" max="100" type="number" matInput>
                                             <mat-icon matIconSuffix style="color: rgba(0, 0, 0, 0.65);"><i
                                        class="fa-solid fa-percent"></i></mat-icon>
                                        </mat-form-field>
                                         <mat-error *ngIf="proportionalForm.get('qoutaShareCommission')?.hasError('min')">
                                            Value cannot be less than 0.
                                            </mat-error>
                                            <mat-error *ngIf="proportionalForm.get('qoutaShareCommission')?.hasError('max')">
                                            Value cannot be more than 100.
                                            </mat-error>
                                         <mat-form-field class="w-100" appearance="outline">
                                                <mat-label>Taxes</mat-label>
                                                <input formControlName="tax" min="0" max="100" type="number" matInput>
                                                 <mat-icon matIconSuffix style="color: rgba(0, 0, 0, 0.65);"><i
                                        class="fa-solid fa-percent"></i></mat-icon>
                                        </mat-form-field>
                                          <mat-error *ngIf="proportionalForm.get('tax')?.hasError('min')">
                                            Value cannot be less than 0.
                                            </mat-error>
                                            <mat-error *ngIf="proportionalForm.get('tax')?.hasError('max')">
                                            Value cannot be more than 100.
                                            </mat-error>
                                    </div>
                                    <div class="col-md-4">
                                        <mat-form-field appearance="outline">
                                            <mat-label>Notice of Cancellation</mat-label>
                                            <input formControlName="noticeOfCancellation" type="number" matInput>
                                        </mat-form-field>
                                        <mat-form-field *ngIf="SelectedPrinciple=='2'||SelectedPrinciple=='3'"
                                            appearance="outline">
                                            <mat-label>Prem Portfolio Withdrawal </mat-label>
                                            <input formControlName="premPortfolioWithdrawal" type="number" matInput>
                                        </mat-form-field>
                                        <mat-form-field appearance="outline">
                                            <mat-label>Accounting</mat-label>
                                            <mat-select formControlName="accounting">
                                                <mat-option [value]="1">Quarterly</mat-option>
                                                <mat-option [value]="2">Half Yearly</mat-option>
                                                <mat-option [value]="3">Yearly</mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                        <mat-form-field appearance="outline">
                                            <mat-label>SOA Currency</mat-label>
                                            <mat-select formControlName="soaCurrency">
                                                <mat-option value="USD">USD</mat-option>
                                                <mat-option value="EGP">EGP</mat-option>
                                                <mat-option value="EUR">EUR</mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                        <mat-form-field appearance="outline">
                                            <mat-label>Loss Carried forward</mat-label>
                                            <mat-select formControlName="lossCarriedForward">
                                                <mat-option [value]="0">0</mat-option>
                                                <mat-option [value]="1">1</mat-option>
                                                <mat-option [value]="2">2</mat-option>
                                                <mat-option [value]="3">3</mat-option>
                                                <mat-option [value]="4">4</mat-option>
                                                <mat-option [value]="5">5</mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                        <mat-form-field class="w-100" appearance="outline">
                                            <mat-label>Final Calculation Date years</mat-label>
                                            <input formControlName="finalCalculation" matInput
                                                [matDatepicker]="picker4">
                                            <mat-datepicker-toggle matIconSuffix
                                                [for]="picker4"></mat-datepicker-toggle>
                                            <mat-datepicker #picker4></mat-datepicker>
                                        </mat-form-field>
                                        <!-- new -->
                                        <mat-form-field appearance="outline">
                                            <mat-label>Select Premuim</mat-label>
                                            <mat-select formControlName="netGrossOption">
                                                <mat-option [value]="2">Gross Premuim</mat-option>
                                                <mat-option [value]="1">Net Premuim</mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                        <mat-form-field appearance="outline">
                                            <mat-label>SurPlus Commision</mat-label>
                                            <input formControlName="surplusCommission" min="0" max="100" type="number" matInput>
                                             <mat-icon matIconSuffix style="color: rgba(0, 0, 0, 0.65);"><i
                                        class="fa-solid fa-percent"></i></mat-icon>
                                        </mat-form-field>
                                         <mat-error *ngIf="proportionalForm.get('surplusCommission')?.hasError('min')">
                                            Value cannot be less than 0.
                                            </mat-error>
                                            <mat-error *ngIf="proportionalForm.get('surplusCommission')?.hasError('max')">
                                            Value cannot be more than 100.
                                            </mat-error>
                                    </div>
                                    <div class="col-md-4">
                                        <mat-form-field appearance="outline">
                                            <mat-label>Loss Advice Limit</mat-label>
                                            <input formControlName="lossAdviceLimit" type="number" matInput>
                                        </mat-form-field>
                                        <mat-form-field *ngIf="SelectedPrinciple=='2'||SelectedPrinciple=='3'"
                                            appearance="outline">
                                            <mat-label>Loss Portfolio Withdrawal </mat-label>
                                            <input formControlName="lossPortfolioWithdrawal" type="number" matInput>
                                        </mat-form-field>
                                        <mat-form-field appearance="outline">
                                            <mat-label>Premium Reserve</mat-label>
                                            <mat-select formControlName="premiumReserve">
                                                <mat-option [value]="1">Reserve release yearly</mat-option>
                                                <mat-option [value]="2">Half yearly</mat-option>
                                                <mat-option [value]="3">Qrter</mat-option>
                                                <mat-option [value]="4">4th qrt</mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                        <mat-form-field appearance="outline">
                                            <mat-label>Premuim Reserve Pct</mat-label>
                                            <input formControlName="premiumReservePct" min="0" max="100" type="number" matInput>
                                             <mat-icon matIconSuffix style="color: rgba(0, 0, 0, 0.65);"><i
                                        class="fa-solid fa-percent"></i></mat-icon>
                                        </mat-form-field>
                                         <mat-error *ngIf="proportionalForm.get('premiumReservePct')?.hasError('min')">
                                            Value cannot be less than 0.
                                            </mat-error>
                                            <mat-error *ngIf="proportionalForm.get('premiumReservePct')?.hasError('max')">
                                            Value cannot be more than 100.
                                            </mat-error>
                                        <mat-form-field appearance="outline">
                                            <mat-label>Interest</mat-label>
                                            <input formControlName="interest" type="number" min="0" max="100" matInput>
                                             <mat-icon matIconSuffix style="color: rgba(0, 0, 0, 0.65);"><i
                                        class="fa-solid fa-percent"></i></mat-icon>
                                        </mat-form-field>
                                         <mat-error *ngIf="proportionalForm.get('interest')?.hasError('min')">
                                            Value cannot be less than 0.
                                            </mat-error>
                                            <mat-error *ngIf="proportionalForm.get('interest')?.hasError('max')">
                                            Value cannot be more than 100.
                                            </mat-error>
                                        <mat-form-field appearance="outline" *ngIf="proportionalForm.get('profitCommission')?.value">
                                            <mat-label>Management Expenses</mat-label>
                                            <input formControlName="managmentExpenses" min="0" max="100" type="number" matInput>
                                             <mat-icon matIconSuffix style="color: rgba(0, 0, 0, 0.65);"><i
                                        class="fa-solid fa-percent"></i></mat-icon>
                                        </mat-form-field>
                                         <mat-error *ngIf="proportionalForm.get('managmentExpenses')?.hasError('min')">
                                            Value cannot be less than 0.
                                            </mat-error>
                                            <mat-error *ngIf="proportionalForm.get('managmentExpenses')?.hasError('max')">
                                            Value cannot be more than 100.
                                            </mat-error>
                                        <!-- Added New -->
                                        <mat-form-field appearance="outline">
                                            <mat-label>Quota Share Limit</mat-label>
                                            <input formControlName="qoutaShareLimit" type="number" matInput>
                                        </mat-form-field>
                                        <mat-form-field class="w-100" appearance="outline">
                                                <mat-label>Full Treaty Limit</mat-label>
                                                <input formControlName="treatyLimit" type="number" matInput>
                                        </mat-form-field>
                                    </div>
                                </div>
                                <hr class="text-danger">
                                <!----- Sub Treaty ----->
                                <div class="d-flex justify-content-between">
                                    <h2 class="fw-bold">Layers <i (click)="viewSubtrireas()"
                                            class="fa-solid fa-eye text-success fs-5 px-2 py-2"></i></h2>

                                </div>
                                <form [formGroup]="SubTreatyForm" class="mx-4">
                                    <div class="row">
                                        <div class="col-6">
                                            <mat-form-field appearance="outline">
                                                <mat-label>Layer Type</mat-label>
                                                <mat-select formControlName="layersType"
                                                    (selectionChange)="getSelectedLayerType($event.value)">
                                                    <mat-option [disabled]="this.childQS!=''" [value]="1">QS</mat-option>
                                                    <mat-option [disabled]="this.childQS==''" [value]="2">Surplus</mat-option>
                                                </mat-select>
                                            </mat-form-field>
                                        </div>
                                        <div class="col-6 d-flex align-items-center justify-content-end">
                                            <h4 style="margin-bottom: 0;" class="fw-bold mx-2">
                                                QS <span class="text-danger"><span
                                                        *ngIf="this.childQS==''">0</span><span
                                                        *ngIf="this.childQS!=''">1</span> </span>
                                            </h4>
                                            <h4 style="margin-bottom: 0;" class="fw-bold mx-2">
                                                Surplus <span class="text-danger">{{this.childSurplusArr.length}}
                                                </span>
                                            </h4>
                                              <!-- [disabled]="SubTreatyForm.status=='INVALID' ||this.arrTest.length==0"
                                                *ngIf="this.SubTreatyForm.get('layersType')?.value!=null" -->
                                            <button
                                                [disabled]="SubTreatyForm.status=='INVALID' ||this.AllPanels.length==0"
                                                *ngIf="this.SubTreatyForm.get('layersType')?.value!=null"
                                                mat-stroked-button (click)="Addchild()" color="primary">
                                                <span *ngIf="this.SubTreatyForm.get('layersType')?.value=='1'">Add QS
                                                </span>
                                                <span *ngIf="this.SubTreatyForm.get('layersType')?.value=='2'">Add
                                                    Surplus </span>
                                                <span><i class="fa-solid fa-circle-plus"></i></span>
                                            </button>
                                        </div>
                                    </div>

                                    <div class="row mt-2">
                                        <div class="col-md-4">
                                            <mat-form-field class="w-100" appearance="outline">
                                                <mat-label>Retention</mat-label>
                                                <input formControlName="retantion" type="number" min="0" max="100" matInput (blur)="setZeroIfEmpty('retantion')">
                                                <mat-icon matIconSuffix style="color: rgba(0, 0, 0, 0.65);"><i
                                                class="fa-solid fa-percent"></i></mat-icon>
                                            </mat-form-field>
                                            <mat-error *ngIf="SubTreatyForm.get('retantion')?.hasError('min')">
                                            Value cannot be less than 0.
                                            </mat-error>
                                            <mat-error *ngIf="SubTreatyForm.get('retantion')?.hasError('max')">
                                            Value cannot be more than 100.
                                            </mat-error>
                                            <mat-form-field class="w-100" appearance="outline">
                                                <mat-label>No. of lines</mat-label>
                                                <input formControlName="noOfLines" type="number" matInput>
                                            </mat-form-field>
                                        </div>
                                        <div class="col-md-4">
                                            <mat-form-field class="w-100" appearance="outline">
                                                <mat-label>Retentional treaty Limit</mat-label>
                                                <input formControlName="treatyLimit" type="number" matInput>
                                            </mat-form-field>
                                        </div>
                                        <div class="col-md-4">
                                            <mat-form-field class="w-100" appearance="outline" id="SurplusLimit" style="display: none;">
                                                <mat-label>Surplus Limit</mat-label>
                                                <input formControlName="surplusLimit" type="number" matInput>
                                            </mat-form-field>
                                        </div>
                                    </div>
                                    <div class="outerBorder shadow_5" *ngIf="SubTreatyForm.get('layersType')?.value==1">
                                        <div class="d-flex justify-content-between mt-2 mx-4">
                                            <h2 class="text-muted">Share<span class="text-danger mx-1">*</span></h2>
                                            <button (click)="AddNew()" mat-raised-button class="btn tabeeb_Btn"
                                                *ngIf="this.arrTest.length>0">Add new <span><i
                                                        class="fa-solid fa-circle-plus"></i></span>
                                            </button>
                                        </div>
                                        <div *ngIf="this.arrTest.length<=0" class="text-center py-3"
                                            style="background-color: #084f5528;">
                                            <h3 style="color: #01909D;font-size: 16px;font-weight: 700;margin: 0;">No
                                                data</h3>
                                            <button (click)="AddNew()" mat-raised-button
                                                class="btn tabeeb_Btn mt-1 mx-2">Add new</button>
                                            <!-- <button *ngIf="this.childQS!='' ||this.childSurplusArr.length>0"
                                                (click)="useRecommendedShare()" mat-raised-button
                                                class="btn tabeeb_Btn mt-1">Use Recommended</button> -->
                                        </div>
                                        <div>

                                            <table *ngIf="this.arrTest.length>0" class="table text-center">
                                                <thead style="background-color: #F2F2F2 !important;">
                                                    <th>Company</th>
                                                    <th>Broker</th>
                                                    <th>CompanyShare</th>
                                                    <th>BrokerShare</th>
                                                    <th></th>
                                                </thead>
                                                <tbody>
                                                    <tr *ngFor="let item of arrTest;let index = index"
                                                        style="vertical-align: middle;">
                                                        <td>{{getCompanyName(item.reInsuranceId)}}</td>
                                                        <td>
                                                            <span *ngIf="item.brokerId==null">-</span>
                                                            <span
                                                                *ngIf="item.brokerId!=null">{{getBrokerName(item.brokerId)}}</span>
                                                        </td>
                                                        <td>{{item.companyPct}}</td>
                                                        <td>{{item.brokerPct}}</td>
                                                        <!-- <td ><button color="warn" (click)="remove(index,item.companyPct)" mat-raised-button>{{'Shared.Remove'|translate}}</button></td> -->
                                                        <td><i (click)="remove(index,item.companyPct)"
                                                                class="fa-regular fa-trash-can fs-5 px-3 py-2"
                                                                style="color:red !important"></i></td>
                                                    </tr>
                                                </tbody>
                                                <tfoot>
                                                    <tr>
                                                        <th colspan="2">Total</th>
                                                        <th>{{this.AllFees}}</th>
                                                        <th colspan="2"></th>
                                                    </tr>
                                                </tfoot>
                                            </table>
                                        </div>
                                    </div>
                                </form>

                            </div>
                        </form>
                    </div>
                    <!----------- Non Proposhinoal ------------------------->
                    <div class="px-3 py-2" id="xl">
                        <form [formGroup]="NonproportionalForm">
                            <div class="assignBorder px-2 py-2">
                                <div class="row">
                                    <div class="col-md-4">
                                        <mat-form-field appearance="outline">
                                            <mat-label>BASE</mat-label>
                                            <mat-select formControlName="principle">
                                                <mat-option [value]="1">RISK ATTACHED </mat-option>
                                                <mat-option [value]="2">LOSS OCCURANCE</mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                         <mat-form-field appearance="outline">
                                            <mat-label>Priority </mat-label>
                                            <input type="number" min="0" formControlName="priority" matInput  (focus)="onPriorityFocus()">
                                        </mat-form-field>
                                        <mat-error *ngIf="NonproportionalForm.hasError('enpiNotGreater')">
                                             Expected EPI must be greater than Priority.
                                        </mat-error>
                                         <mat-error *ngIf="NonproportionalForm.get('priority')?.hasError('min')">
                                                Value cannot be less than 0.
                                        </mat-error>
                                    </div>
                                    <div class="col-md-4">
                                        <mat-form-field appearance="outline">
                                            <mat-label>Notice of Cancellation </mat-label>
                                            <input type="number" formControlName="noticeOfCancellation" matInput>
                                        </mat-form-field>
                                        <mat-form-field appearance="outline">
                                            <mat-label>Expected Epi </mat-label>
                                            <input min="0" type="number" formControlName="enpi" matInput>
                                        </mat-form-field>
                                         <mat-error *ngIf="NonproportionalForm.get('enpi')?.hasError('min')">
                                                Value cannot be less than 0.
                                        </mat-error>
                                    </div>
                                    <div class="col-md-4">
                                          <mat-form-field appearance="outline">
                                            <mat-label>mdPct </mat-label>
                                            <input type="number" min="0" max="100" formControlName="mdPct" matInput>
                                            <mat-icon matIconSuffix style="color: rgba(0, 0, 0, 0.65);"><i
                                            class="fa-solid fa-percent"></i></mat-icon>
                                        </mat-form-field>
                                        <mat-error *ngIf="NonproportionalForm.get('mdPct')?.hasError('min')">
                                        Value cannot be less than 0.
                                        </mat-error>
                                        <mat-error *ngIf="NonproportionalForm.get('mdPct')?.hasError('max')">
                                        Value cannot be more than 100.
                                        </mat-error>
                                    </div>
                                </div>
                                 <div class="mt-3">
                                            <h3>{{'Policy.PaymentPeriod'|translate}}<span class="text-danger">*</span>
                                            </h3>
                                            <mat-radio-group
                                                (change)="getPaymentPeriod($event.value)" formControlName="nonPropotionalInstallments" aria-label="Select an option">
                                                <mat-radio-button class="mx-2" [value]="0">Yearly</mat-radio-button>
                                                <mat-radio-button class="mx-2" [value]="1">Half Yearly</mat-radio-button>
                                                <mat-radio-button class="mx-2" [value]="2">Quarterly</mat-radio-button>
                                                <mat-radio-button class="mx-2" [value]="3">Other</mat-radio-button>
                                            </mat-radio-group>
                                        </div>
                                          <!-- تواريــخ الســـداد -->
                                    <div class="row">
                                        <!-- 1 -->
                                        <div class="col-md-3">
                                            <mat-form-field style="display: none;" class="w-100 payment1 feo"
                                                appearance="outline">
                                                <mat-label>{{'Policy.paymentDate1'|translate}}</mat-label>
                                                <input formControlName="settlement1" matInput [matDatepicker]="picker12">
                                                <mat-datepicker-toggle matIconSuffix
                                                    [for]="picker12"></mat-datepicker-toggle>
                                                <mat-datepicker #picker12></mat-datepicker>
                                            </mat-form-field>
                                        </div>
                                        <!-- 2 -->
                                        <div class="col-md-3">
                                            <mat-form-field style="display: none;" class="w-100 payment2 feo"
                                                appearance="outline">
                                                <mat-label>{{'Policy.paymentDate2'|translate}}</mat-label>
                                                <input formControlName="settlement2" matInput [matDatepicker]="picker13">
                                                <mat-datepicker-toggle matIconSuffix
                                                    [for]="picker13"></mat-datepicker-toggle>
                                                <mat-datepicker #picker13></mat-datepicker>
                                            </mat-form-field>

                                        </div>

                                        <!-- 3 -->
                                        <div class="col-md-3">
                                            <mat-form-field style="display: none;" class="w-100 payment3 feo"
                                                appearance="outline">
                                                <mat-label>{{'Policy.paymentDate3'|translate}}</mat-label>
                                                <input formControlName="settlement3" matInput [matDatepicker]="picker9">
                                                <mat-datepicker-toggle matIconSuffix
                                                    [for]="picker9"></mat-datepicker-toggle>
                                                <mat-datepicker #picker9></mat-datepicker>
                                            </mat-form-field>
                                        </div>

                                        <!-- 4 -->
                                        <div class="col-md-3">
                                            <mat-form-field style="display: none;" class="w-100 payment4 feo"
                                                appearance="outline">
                                                <mat-label>{{'Policy.paymentDate4'|translate}}</mat-label>
                                                <input formControlName="settlement4" matInput
                                                    [matDatepicker]="picker10">
                                                <mat-datepicker-toggle matIconSuffix
                                                    [for]="picker10"></mat-datepicker-toggle>
                                                <mat-datepicker #picker10></mat-datepicker>
                                            </mat-form-field>
                                        </div>
                                        <div style="display: none;" class="col-md-12 OtherSettlement">
                                            <div class="row">
                                                <div class="col-md-4">
                                                    <mat-form-field class="w-100 feo" appearance="outline">
                                                        <mat-label>Enter Settlement</mat-label>
                                                        <input [min]="currentInceptionDate" [(ngModel)]="otherDate"
                                                            [ngModelOptions]="{standalone: true}" matInput
                                                            [matDatepicker]="picker20">
                                                        <mat-datepicker-toggle matIconSuffix
                                                            [for]="picker20"></mat-datepicker-toggle>
                                                        <mat-datepicker #picker20></mat-datepicker>
                                                    </mat-form-field>
                                                </div>
                                                <div class="col-md-3 mt-2">
                                                    <button mat-raised-button color="accent" (click)="viewDates()"
                                                        [disabled]="otherDate==''" style="width: 20%;" class="mx-1">
                                                        Add
                                                    </button>
                                                </div>
                                            </div>
                                            <!-- Table Of Settlements -->
                                            <table *ngIf="this.arrDates.length>0"
                                                class="table table-striped text-center w-75">
                                                <thead>
                                                    <th>#</th>
                                                    <th>Settlement Date</th>
                                                    <th>remove</th>
                                                </thead>
                                                <tbody>
                                                    <tr *ngFor="let item of arrDates;let index = index"
                                                        class="align-middle">
                                                        <td>{{index+1}}</td>
                                                        <td>{{item.date}}</td>
                                                        <td><button color="warn" (click)="removeDate(index)"
                                                                mat-raised-button>{{'Shared.Remove'|translate}}</button>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                <hr class="text-danger">



                                <!----- Sub Treaty ----->
                                <div class="d-flex justify-content-between">
                                    <h2 class="fw-bold">Layers <i (click)="viewSubtrireas()"
                                            class="fa-solid fa-eye text-success fs-5 px-2 py-2"></i></h2>
                                </div>
                                <form [formGroup]="SubTreatyXLForm" class="mx-4">
                                    <div class="row">
                                        <div class="col-6">

                                        </div>
                                        <div class="col-6 d-flex align-items-center justify-content-end">
                                            <h4 style="margin-bottom: 0;" class="fw-bold mx-2">
                                                layer  <span class="text-danger">{{this.childSurplusArr.length}}
                                                </span>
                                            </h4>
                                            <button [disabled]="SubTreatyXLForm.status=='INVALID' || NonproportionalForm.hasError('enpiNotGreater')" mat-stroked-button
                                                (click)="Addchild()" color="primary">
                                                Add layer 
                                                <span><i class="fa-solid fa-circle-plus"></i></span>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="row mt-2"> 
                                        <!-- <mat-error *ngIf="SubTreatyXLForm.hasError('atLeastOneRequired')">
                                            Please enter a value in at least one of the No. of Reinstatements or
                                            Aggregate Limit fields.
                                        </mat-error>  -->
                                        <div class="col-md-4">
                                            <mat-form-field class="w-100" appearance="outline">
                                                <mat-label><span class="text-danger mx-1">*</span>Layer Risk Type </mat-label>
                                                <mat-select formControlName="layerRiskType">
                                                    <mat-option *ngFor="let item of AllLayerRiskType" [value]="item.id">{{item.name}}</mat-option>
                                                </mat-select>
                                            </mat-form-field>
                                        </div>
                                        <div class="col-md-4">
                                            <mat-form-field class="w-100" appearance="outline">
                                                <mat-label>Limit</mat-label>
                                                <input formControlName="limit" min="0" type="number" matInput>
                                            </mat-form-field>
                                            <mat-error *ngIf="SubTreatyXLForm.get('limit')?.hasError('min')">
                                        Value cannot be less than 0.
                                        </mat-error>
                                        </div>
                                        <div class="col-md-4">
                                              <mat-form-field class="w-100" appearance="outline">
                                                <mat-label>Excess</mat-label>
                                                <input formControlName="excess" type="number" min="0" matInput>
                                            </mat-form-field>
                                                 <mat-error *ngIf="SubTreatyXLForm.get('excess')?.hasError('min')">
                                        Value cannot be less than 0.
                                        </mat-error>
                                        </div>
                                        <div class="col-md-4" *ngIf="!SubTreatyXLForm.get('reinstatementNumber')?.value">
                                              <mat-form-field class="w-100" appearance="outline">
                                                <mat-label>Aggregate</mat-label>
                                                <input formControlName="aggregate" type="number" matInput>
                                            </mat-form-field>
                                                      <mat-error *ngIf="SubTreatyXLForm.get('aggregate')?.hasError('min')">
                                        Value cannot be less than 0.
                                        </mat-error>
                                        </div>
                                        <div class="col-md-4">
                                              <mat-form-field class="w-100" appearance="outline">
                                                <mat-label>Adjustable Rate </mat-label>
                                                <input formControlName="adjustableRate" min="0" type="number" matInput>
                                            </mat-form-field>
                                                      <mat-error *ngIf="SubTreatyXLForm.get('adjustableRate')?.hasError('min')">
                                        Value cannot be less than 0.
                                        </mat-error>
                                        </div>
                                        <div class="col-md-4">
                                              <mat-form-field class="w-100" appearance="outline">
                                                <mat-label>MinimumAndDeposit</mat-label>
                                                <input formControlName="minimumAndDeposit" min="0" type="number" matInput>
                                            </mat-form-field>
                                                        <mat-error *ngIf="SubTreatyXLForm.get('minimumAndDeposit')?.hasError('min')">
                                        Value cannot be less than 0.
                                        </mat-error>
                                        </div>
                                        <div class="col-md-4" *ngIf="!SubTreatyXLForm.get('aggregate')?.value">
                                              <mat-form-field class="w-100" appearance="outline">
                                                <mat-label>ReinstatementNumber</mat-label>
                                                <input formControlName="reinstatementNumber" type="number" matInput>
                                            </mat-form-field>
                                                         <mat-error *ngIf="SubTreatyXLForm.get('reinstatementNumber')?.hasError('min')">
                                        Value cannot be less than 0.
                                        </mat-error>
                                        </div>
                                        <div class="col-md-4" *ngIf="SubTreatyXLForm.get('reinstatementNumber')?.value">
                                            <mat-form-field class="w-100" appearance="outline">
                                                <mat-label>Reinstatement@</mat-label>
                                                <input formControlName="flatReInstatment" min="0" type="number" matInput>
                                                <mat-icon matIconSuffix style="color: rgba(0, 0, 0, 0.65);"><i
                                                class="fa-solid fa-percent"></i></mat-icon>
                                            </mat-form-field>
                                        </div>
                                       
                                    </div>
                                  

                                </form>
                                <div class="outerBorder shadow_5 mt-2">
                                    <div class="d-flex justify-content-between mt-2 mx-4">
                                            <h2 class="text-muted">Share<span class="text-danger mx-1">*</span></h2>
                                            <button (click)="AddNewnon()" mat-raised-button class="btn tabeeb_Btn"
                                                *ngIf="this.arrTest.length>0">Add new <span><i
                                                        class="fa-solid fa-circle-plus"></i></span>
                                            </button>
                                    </div>
                                     <div *ngIf="this.arrTest.length<=0" class="text-center py-3"
                                            style="background-color: #084f5528;">
                                            <h3 style="color: #01909D;font-size: 16px;font-weight: 700;margin: 0;">No
                                                data</h3>
                                            <button (click)="AddNewnon()" mat-raised-button
                                                class="btn tabeeb_Btn mt-1 mx-2">Add new
                                            </button>
                                     </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
                <!-- Submit Btns -->
                <div class="d-flex justify-content-between">
                    <button *ngIf="this.MainForm.get('type')?.value==1" id="Save" (click)="SubmitReInsurTreatySetup()"
                        [disabled]="this.MainForm.status=='INVALID'|| this.proportionalForm.status=='INVALID' || this.isClicked || (childQS==''&&childSurplusArr.length==0)" 
                        mat-raised-button color="primary" class="w-25 mt-3 tabeeb_Btn">
                        <span *ngIf="!this.isClicked">Save <i class="fa-solid fa-floppy-disk"></i></span>
                        <span *ngIf="this.isClicked"><i class="fa-solid fa-fan fa-spin"></i></span>
                    </button>
                    <button *ngIf="this.MainForm.get('type')?.value==2" id="Save" (click)="SubmitNonProfossionalReInsurTreatySetup()"
                        [disabled]="this.MainForm.status=='INVALID'|| this.NonproportionalForm.status=='INVALID' || this.isClicked || AllPanels.length==0 || !this.checkIfLeader()" 
                        mat-raised-button color="primary" class="w-25 mt-3 tabeeb_Btn">
                        <span *ngIf="!this.isClicked">Save <i class="fa-solid fa-floppy-disk"></i></span>
                        <span *ngIf="this.isClicked"><i class="fa-solid fa-fan fa-spin"></i></span>
                    </button>
                    <button style="display: none;" id="New" (click)="new()" mat-raised-button color="accent"
                        class="w-25 mt-3">
                        New Treaty ?
                    </button>
                    <table id="TreatySetup" style="display: none;"
                        class="table table-striped table-bordered text-center mt-3 w-50">
                        <tbody>
                            <tr>
                                <th class="w-30">Treaty Setup Name</th>
                                <td class="w-60 text-danger">{{treatySetupName}}</td>
                            </tr>
                        </tbody>
                    </table>

                </div>
            </form>
        </div>
    </div>
</div>



<!-- Add Company With Share -->
<div class="overlayEdit" (click)="closeAddNew()">
    <div class="Editgovernmant" (click)="$event.stopPropagation()">
        <div class="d-flex justify-content-between delet-details">
            <h2>New Share</h2>
            <div class="d-flex align-items-center justify-content-center"><i
                    class="fa-solid fa-xmark text-danger text-center" (click)="closeAddNew()"
                    style="cursor: pointer;"></i></div>
        </div>
        <hr class="custom-hr w-100">
        <div class="container">
            <form [formGroup]="CompanyShareForm" class="mt-5">
                <div class="row">
                     <div class="col-4">
                          <mat-form-field class="w-100 mt-2" appearance="outline">
                            <mat-label>Panel</mat-label>
                            <mat-select formControlName="panel">
                                <!-- <mat-option value="">Null</mat-option> -->
                                <mat-option *ngFor="let item of PanalesType" [disabled]="(leaderAlreadyExists && item.id == 1) || (checkIfLeaderWithFullShareExists2() && item.id == 2) || (AllPanels.length == 0 && item.id == 2)" [value]="item.id">{{item.name}}</mat-option>
                            </mat-select>
                            <mat-icon matIconSuffix style="color: rgba(0, 0, 0, 0.65);"><i
                                    class="fa-solid fa-people-arrows"></i></mat-icon>
                        </mat-form-field>
                    </div>
                     <div class="col-4">
                          <mat-form-field class="w-100 mt-2" appearance="outline">
                                <mat-label>Reinsurer Name</mat-label>
                                 <mat-select formControlName="companyId">
                                <mat-option *ngFor="let item of AllReInsurCompanies" [value]="item.id">{{item.name}}</mat-option>
                            </mat-select>
                            <mat-icon matIconSuffix style="color: rgba(0, 0, 0, 0.65);"><i
                            class="fa-solid fa-people-arrows"></i></mat-icon>
                           </mat-form-field>
                    </div>
                    <div class="col-4">
                          <mat-form-field class="w-100 mt-2" appearance="outline">
                            <mat-label>Broker</mat-label>
                            <mat-select formControlName="brokerId">
                                <mat-option value="">Null</mat-option>
                                <mat-option *ngFor="let item of AllReInsurBrokers" [value]="item.id">{{item.name}}</mat-option>
                            </mat-select>
                            <mat-icon matIconSuffix style="color: rgba(0, 0, 0, 0.65);"><i
                                    class="fa-solid fa-people-arrows"></i></mat-icon>
                        </mat-form-field>
                    </div> 
                     <div class="col-4">
                          <mat-form-field class="w-100 mt-2" appearance="outline">
                                <mat-label>Reinsurance Pct</mat-label>
                                <input formControlName="companyPct" type="number" matInput>
                                <mat-icon matIconSuffix style="color: rgba(0, 0, 0, 0.65);"><i
                                        class="fa-solid fa-percent"></i></mat-icon>
                           </mat-form-field>
                    </div>
                     <div class="col-4" *ngIf="CompanyShareForm.get('brokerId')?.value">
                          <mat-form-field class="w-100 mt-2" appearance="outline">
                                <mat-label>Broker Pct</mat-label>
                                <input #brokerShare formControlName="brokerPct" type="number" matInput>
                                <mat-icon matIconSuffix style="color: rgba(0, 0, 0, 0.65);"><i
                                        class="fa-solid fa-percent"></i></mat-icon>
                           </mat-form-field>
                    </div>
                     <div class="col-4">
                          <mat-form-field class="w-100 mt-2" appearance="outline">
                                <mat-label>Reinsurance Limit</mat-label>
                                <input formControlName="reinsurancLimite" type="number" matInput>
                           </mat-form-field>
                    </div>
                    <div class="d-flex justify-content-between align-items-center" style="padding: 2rem 3px 2rem 3px;">
                        <button [disabled]="this.CompanyShareForm.status=='INVALID'" class="btn _cancel w-50 mx-1"
                            (click)="View()">
                            <span *ngIf="!this.isClicked">Save</span>
                            <span *ngIf="this.isClicked"><i class="fa-solid fa-fan fa-spin"></i></span>
                        </button>
                        <button class="btn _delete w-50 mx-1" (click)="closeAddNew()">Cancel</button>
                    </div>
                </div>
            </form>
            <table border="1" class="table text-center mx-2" *ngIf="AllPanels.length>0">
                    <thead style="background-color: #F2F2F2 !important;">
                        <tr>
                            <th>#</th>
                            <th>Panel</th>
                            <th>Reinsurer Name</th>
                            <th>Broker Name</th>
                            <th>companyPct</th>
                            <th>Commission</th>
                            <th>remove</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let item of AllPanels;let i=index">
                            <td>{{i+1}}</td>
                            <td>{{getPanelName(item.panel)}}</td>
                            <td>{{getCompanyName(item.companyId)}}</td>
                            <td>{{getBrokerName(item?.brokerId)}}</td>
                            <td>{{item?.companyPct  || '--'}}</td>
                            <td>{{item?.brokerPct  || '--'}}</td>
                            <td><button color="warn" (click)="removeleaderorfollower(i)"
                            mat-raised-button>{{'Shared.Remove'|translate}}</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
        </div>
    </div>
</div>
<!-- Add Company With Share non proposhonal -->
<div class="overlayEditNon" (click)="closeAddNewnon()">
    <div class="EditgovernmantNon" (click)="$event.stopPropagation()">
        <div class="d-flex justify-content-between delet-details">
            <h2>New Share</h2>
            <div class="d-flex align-items-center justify-content-center"><i
                    class="fa-solid fa-xmark text-danger text-center" (click)="closeAddNewnon()"
                    style="cursor: pointer;"></i></div>
        </div>
        <hr class="custom-hr w-100">
        <div class="container">
            <form [formGroup]="CompanySharenonForm" class="mt-5">
                <div class="row">
                    <div class="col-4">
                          <mat-form-field class="w-100 mt-2" appearance="outline">
                            <mat-label>Panel</mat-label>
                            <mat-select formControlName="panel">
                                <!-- <mat-option value="">Null</mat-option> -->
                                <mat-option *ngFor="let item of PanalesType" [disabled]="(leaderAlreadyExists && item.id == 1) || (checkIfLeaderWithFullShareExists() && item.id == 2) || (AllPanels.length == 0 && item.id == 2)" [value]="item.id">{{item.name}}</mat-option>
                            </mat-select>
                            <mat-icon matIconSuffix style="color: rgba(0, 0, 0, 0.65);"><i
                                    class="fa-solid fa-people-arrows"></i></mat-icon>
                        </mat-form-field>
                    </div>
                     <div class="col-4" *ngIf="CompanySharenonForm.get('panel')?.value==1">
                        <mat-form-field class="w-100 mt-2" appearance="outline">
                                <mat-label>Fees Pct</mat-label>
                                <input formControlName="fess" type="number" min="0" max="100" matInput>
                                <mat-icon matIconSuffix style="color: rgba(0, 0, 0, 0.65);"><i
                                        class="fa-solid fa-percent"></i></mat-icon>
                                <mat-error *ngIf="CompanySharenonForm.get('fess')?.hasError('min')">
                                    Value cannot be less than 0.
                                    </mat-error>
                                    <mat-error *ngIf="CompanySharenonForm.get('fess')?.hasError('max')">
                                    Value cannot be more than 100.
                                </mat-error>        
                        </mat-form-field>
                    </div>
                     <div class="col-4">
                          <mat-form-field class="w-100 mt-2" appearance="outline">
                                <mat-label>Reinsurance Name</mat-label>
                                 <mat-select formControlName="reInsuranceId">
                                <mat-option *ngFor="let item of AllReInsurCompanies" [value]="item.id">{{item.name}}</mat-option>
                            </mat-select>
                            <mat-icon matIconSuffix style="color: rgba(0, 0, 0, 0.65);"><i
                            class="fa-solid fa-people-arrows"></i></mat-icon>
                           </mat-form-field>
                    </div>
                    <div class="col-4">
                          <mat-form-field class="w-100 mt-2" appearance="outline">
                            <mat-label>Broker</mat-label>
                            <mat-select formControlName="reInsuranceBrokerId">
                                <mat-option value="">Null</mat-option>
                                <mat-option *ngFor="let item of AllReInsurBrokers" [value]="item.id">{{item.name}}</mat-option>
                            </mat-select>
                            <mat-icon matIconSuffix style="color: rgba(0, 0, 0, 0.65);"><i
                                    class="fa-solid fa-people-arrows"></i></mat-icon>
                        </mat-form-field>
                    </div> 
                     <div class="col-4">
                          <mat-form-field class="w-100 mt-2" appearance="outline">
                                <mat-label>ReInsurance Pct</mat-label>
                                <input formControlName="reInsurancePct" type="number" min="0" max="100" matInput>
                                <mat-icon matIconSuffix style="color: rgba(0, 0, 0, 0.65);"><i
                                        class="fa-solid fa-percent"></i></mat-icon>
                                <mat-error *ngIf="CompanySharenonForm.get('reInsurancePct')?.hasError('min')">
                                    Value cannot be less than 0.
                                    </mat-error>
                                    <mat-error *ngIf="CompanySharenonForm.get('reInsurancePct')?.hasError('max')">
                                    Value cannot be more than 100.
                                </mat-error> 
                           </mat-form-field>
                    </div>
                     <div class="col-4" *ngIf="CompanySharenonForm.get('reInsuranceBrokerId')?.value">
                          <mat-form-field class="w-100 mt-2" appearance="outline">
                                <mat-label>Broker Commission</mat-label>
                                <input  formControlName="brokerCommission" type="number" min="0" max="100" matInput>
                                <mat-icon matIconSuffix style="color: rgba(0, 0, 0, 0.65);"><i
                                        class="fa-solid fa-percent"></i></mat-icon>
                                         <mat-error *ngIf="CompanySharenonForm.get('brokerCommission')?.hasError('min')">
                                    Value cannot be less than 0.
                                    </mat-error>
                                    <mat-error *ngIf="CompanySharenonForm.get('brokerCommission')?.hasError('max')">
                                    Value cannot be more than 100.
                                </mat-error> 
                           </mat-form-field>
                    </div>
                  
                     <!-- <div class="col-4">
                          <mat-form-field class="w-100 mt-2" appearance="outline">
                                <mat-label>Minimum And Deposit Share</mat-label>
                                <input formControlName="minimumAndDepositShare" type="number" min="0" max="100" matInput>
                                <mat-icon matIconSuffix style="color: rgba(0, 0, 0, 0.65);"><i
                                        class="fa-solid fa-percent"></i></mat-icon>
                                <mat-error *ngIf="CompanySharenonForm.get('minimumAndDepositShare')?.hasError('min')">
                                    Value cannot be less than 0.
                                    </mat-error>
                                    <mat-error *ngIf="CompanySharenonForm.get('minimumAndDepositShare')?.hasError('max')">
                                    Value cannot be more than 100.
                            </mat-error> 
                           </mat-form-field>
                    </div> -->
                     <!-- <div class="col-4">
                          <mat-form-field class="w-100 mt-2" appearance="outline">
                                <mat-label>Reinsurance Limit</mat-label>
                                <input formControlName="reinsurancLimite" type="number" matInput>
                           </mat-form-field>
                    </div> -->
                    <!--  -->
                    <div class="d-flex justify-content-between align-items-center" style="padding: 2rem 3px 2rem 3px;">
                        <button [disabled]="this.CompanySharenonForm.status=='INVALID'"  class="btn _cancel w-50 mx-1"
                            (click)="ViewNonpropo()">
                            <span *ngIf="!this.isClicked">Save</span>
                            <span *ngIf="this.isClicked"><i class="fa-solid fa-fan fa-spin"></i></span>
                        </button>
                        <button class="btn _delete w-50 mx-1" (click)="closeAddNew()">Cancel</button>
                    </div>
                </div>
            </form>
            <table border="1" class="table text-center mx-2" *ngIf="AllPanels.length>0">
                    <thead style="background-color: #F2F2F2 !important;">
                        <tr>
                            <th>#</th>
                            <th>Panel</th>
                            <th>Reinsurer Name</th>
                            <th>Broker Name</th>
                            <th>ReInsurancePct</th>
                            <th>brokerCommission</th>
                            <th>Minimum And DepositShare</th>
                            <th>Total Minimum And Deposit</th>
                            <th>remove</th>

                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let item of AllPanels;let i=index">
                            <td>{{i+1}}</td>
                            <td>{{getPanelName(item.panel)}}</td>
                            <td>{{getCompanyNameNon(item.reInsuranceId)}}</td>
                            <td>{{getBrokerName(item?.reInsuranceBrokerId)}}</td>
                            <td>{{item?.reInsurancePct  || '--'}}</td>
                            <td>{{item?.brokerCommission  || '--'}}</td>
                            <!-- <td>{{item?.minimumAndDepositShare  || '--'}}</td> -->
                             <td *ngIf="item.panel==1">{{this.Result2}}</td>
                            <td *ngIf="item.panel==2">{{this.totoalofmimanddeposit}}</td>
                            <!--  -->
                            <td *ngIf="item.panel==1">{{this.LeaderTotal}}</td>
                            <td *ngIf="item.panel==2">{{this.FowlloerTotal}}</td>
                            <td><button color="warn" (click)="removeleaderorfollower(i)"
                            mat-raised-button>{{'Shared.Remove'|translate}}</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
        </div>
    </div>
</div>
<!-- View Subtreates -->
<div class="overlay" (click)="closeSubtrireas()">
    <div class="delet" (click)="$event.stopPropagation()">
        <div class="d-flex justify-content-between delet-details">
            <h2>Subtreaty Details</h2>
            <div class="d-flex align-items-center justify-content-center"><i
                    class="fa-solid fa-xmark text-danger text-center" (click)="closeSubtrireas()"
                    style="cursor: pointer;"></i></div>
        </div>
        <hr class="custom-hr w-100">
        <div class="container">
            <div id="proposed">
                <hr>
                <!-- Proportional -->
                <div class="proprtion" *ngIf="this.MainForm.get('type')?.value=='1'">
                    <!-- QS  -->
                <h2 *ngIf="childQS!=''" class="fs-6 fw-bold" style="margin-bottom: 0!important;">QS <i
                    (click)="removeQS()" class="fa-solid fa-trash text-danger px-1 py-1"></i></h2>
            <div class="row" *ngIf="childQS!=''">
                <div class="col-6">
                    <table class="table table-striped table-bordered text-center mt-2" style="border-radius: 50px;">
                        <tbody>
                            <tr>
                                <th class="w-30 py-3">Retention</th>
                                <td class="w-60 py-3">{{childQS?.retantion}}</td>
                            </tr>
                            <tr>
                                <th class="w-30 py-3">Limit</th>
                                <td class="w-60 py-3">{{childQS?.treatyLimit}}</td>
                            </tr>

                            <tr>
                                <th class="w-30 py-3">Lines</th>
                                <td class="w-60 py-3">{{childQS?.noOfLines}}</td>
                            </tr>

                        </tbody>
                    </table>
                </div>
                <div class="col-6">
                    <table class="table table-striped table-bordered text-center mt-2" style="border-radius: 50px;">
                        <tbody>
                            <tr>
                                <th class="w-30 py-3">Profit</th>
                                <td class="w-60 py-3">{{childQS?.profitCommission}}</td>
                            </tr>
                            <tr>
                                <th class="w-30 py-3">Taxes</th>
                                <td class="w-60 py-3">{{childQS?.tax}}</td>
                            </tr>
                            <tr>
                                <th class="w-30 py-3">Commission</th>
                                <td class="w-60 py-3">{{childQS?.treatyCommission}}</td>
                            </tr>

                        </tbody>
                    </table>
                </div>
                  <table border="1" class="table text-center mx-2" *ngIf="AllPanels.length>0">
                   <thead style="background-color: #F2F2F2 !important;">
                        <tr>
                            <th>#</th>
                            <!-- <th>Panel</th> -->
                            <th>Reinsurer Name</th>
                            <th>Broker Name</th>
                            <th>companyPct</th>
                            <th>Commission</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let item of AllPanels;let i=index">
                            <td>{{i+1}}</td>
                            <!-- <td>{{getPanelName(item.Panel)}}</td> -->
                            <td>{{getCompanyName(item.companyId)}}</td>
                            <td>{{getBrokerName(item?.brokerId)}}</td>
                            <td>{{item?.companyPct  || '--'}}</td>
                            <td>{{item?.brokerPct  || '--'}}</td>
                        </tr>
                    </tbody>
                </table>
                <hr>
            </div>
            <!-- Surplus  -->
            <div *ngFor="let item of childSurplusArr;let index=index" class="row">
                <h2 class="fs-6 fw-bold" style="margin-bottom: 0!important;">Surplus {{index+1}} <i
                        (click)="removeSurplus(index)" class="fa-solid fa-trash text-danger px-1 py-1"></i></h2>
                <div class="col-6">
                    <table class="table table-striped table-bordered text-center mt-2" style="border-radius: 50px;">
                        <tbody>
                            <tr>
                                <th class="w-30 py-3">retention</th>
                                <td class="w-60 py-3">{{item?.retantion}}</td>
                            </tr>
                            <!-- <tr>
                                <th class="w-30 py-3">limit</th>
                                <td class="w-60 py-3">{{item?.treatyLimit}}</td>
                            </tr> -->
                            <tr>
                                <th class="w-30 py-3">lines</th>
                                <td class="w-60 py-3">{{item?.noOfLines}}</td>
                            </tr>

                        </tbody>
                    </table>
                </div>
                <div class="col-6">
                    <table class="table table-striped table-bordered text-center mt-2" style="border-radius: 50px;">
                        <tbody>
                            <tr>
                                <th class="w-30 py-3">Profit</th>
                                <td class="w-60 py-3">{{item?.profitCommission}}</td>
                            </tr>
                            <tr>
                                <th class="w-30 py-3">Taxes</th>
                                <td class="w-60 py-3">{{item?.tax}}</td>
                            </tr>
                            <tr>
                                <th class="w-30 py-3">Commission</th>
                                <td class="w-60 py-3">{{item?.treatyCommission}}</td>
                            </tr>

                        </tbody>
                    </table>
                </div>
                  <!-- <table border="1" class="table text-center mx-2" *ngIf="AllPanels.length>0">
                   <thead style="background-color: #F2F2F2 !important;">
                        <tr>
                            <th>#</th>
                            <th>Panel</th>
                            <th>Reinsurer Name</th>
                            <th>Broker Name</th>
                            <th>CompanyPct</th>
                            <th>Commission</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let item of AllPanels;let i=index">
                            <td>{{i+1}}</td>
                            <td>{{getPanelName(item.Panel)}}</td>
                            <td>{{getCompanyName(item.companyId)}}</td>
                            <td>{{getBrokerName(item?.brokerId)}}</td>
                            <td>{{item?.companyPct  || '--'}}</td>
                            <td>{{item?.brokerPct  || '--'}}</td>
                        </tr>
                    </tbody>
                </table> -->
                <hr>
            </div>
                </div>
                <!--Non Proposional -->
                <div class="XL" *ngIf="this.MainForm.get('type')?.value=='2'">
                    <div *ngFor="let item of childSurplusArr;let index=index" class="row">
                        <h2 class="fs-6 fw-bold" style="margin-bottom: 0!important;">layer {{index+1}} <i
                                (click)="removeSurplus(index)" class="fa-solid fa-trash text-danger px-1 py-1"></i></h2>
                        <div class="col-6">
                            <table class="table table-striped table-bordered text-center mt-2" style="border-radius: 50px;">
                                <tbody>
                                    <!-- <tr>
                                        <th class="w-30 py-3">Flat Premium</th>
                                        <td class="w-60 py-3">
                                            {{ item?.flat == 1 ? 'Yes' : 'No' }}
                                        </td>
                                    </tr> -->
                                    <tr>
                                        <th class="w-30 py-3">layerRiskType</th>
                                        <td class="w-60 py-3">{{item?.layerRiskType}}</td>
                                    </tr>
        
                                    <tr>
                                        <th class="w-30 py-3">reinstatementNumber</th>
                                        <td class="w-60 py-3">{{item?.reinstatementNumber}}</td>
                                    </tr>
                                    <tr>
                                        <th class="w-30 py-3">limit</th>
                                        <td class="w-60 py-3">{{item?.limit}}</td>
                                    </tr>
                                    
                                    <!-- <tr *ngIf="item?.Settlement1!=''">
                                        <th class="w-30 py-3">Settlement 1</th>
                                        <td class="w-60 py-3">{{item?.Settlement1}}</td>
                                    </tr>
                                    <tr *ngIf="item?.Settlement3!=''">
                                        <th class="w-30 py-3">Settlement 3</th>
                                        <td class="w-60 py-3">{{item?.Settlement3}}</td>
                                    </tr>
                                    <tr *ngFor="let ite of item?.other; let i = index" 
                                    [hidden]="i % 2 !== 0">
                                        <th class="w-30 py-3">Settlement {{i +1}}</th>
                                        <td class="w-60 py-3">{{ite?.date}}</td>
                                    </tr> -->
                                </tbody>
                            </table>
                        </div>
                        <div class="col-6">
                            <table class="table table-striped table-bordered text-center mt-2" style="border-radius: 50px;">
                                <tbody>
                                    <tr>
                                        <th class="w-30 py-3">excess</th>
                                        <td class="w-60 py-3">{{item?.excess}}</td>
                                    </tr>
                                    <!-- <tr>
                                        <th class="w-30 py-3">Max</th>
                                        <td class="w-60 py-3">{{item?.max}}</td>
                                    </tr> -->
                                    <tr>
                                        <th class="w-30 py-3">Aggregate Limit</th>
                                        <td class="w-60 py-3">{{item?.aggregate}}</td>
                                    </tr>
                                    <tr>
                                        <th class="w-30 py-3">adjustableRate</th>
                                        <td class="w-60 py-3">{{item?.adjustableRate}}</td>
                                    </tr>
                                    <!-- <tr *ngIf="item?.Settlement2!=''">
                                        <th class="w-30 py-3">Settlement 2</th>
                                        <td class="w-60 py-3">{{item?.Settlement2}}</td>
                                    </tr>
                                    <tr *ngIf="item?.Settlement4!=''">
                                        <th class="w-30 py-3">Settlement 4</th>
                                        <td class="w-60 py-3">{{item?.Settlement4}}</td>
                                    </tr>
                                    <tr *ngFor="let it of item?.other; let i = index" 
                                    [hidden]="i % 2 == 0">
                                        <th class="w-30 py-3">Settlement {{i +1}}</th>
                                        <td class="w-60 py-3">{{it?.date}}</td>
                                    </tr> -->
                                </tbody>
                            </table>
                        </div>
                    
                        <!-- <div class="row">
                            <p class=" fs-6 mx-2">Business </p>
                            <div class="col-4" *ngFor="let item of item?.buisness">
                                <div class="BusBox">
                                    {{item}}
                                </div>
                            </div>
                        </div> -->
                        <hr class="mt-2">
                    </div>

                </div>
                
            </div>
        </div>
    </div>
</div>